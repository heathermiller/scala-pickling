<!DOCTYPE html>  
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>index</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
/*
This document has been created with Marked.app <http://markedapp.com>, Copyright 2013 Brett Terpstra
Content is property of the document author
Please leave this notice in place, along with any additional credits below.
---------------------------------------------------------------
Title: GitHub
Author: Brett Terpstra
Description: Github README style. Includes theme for Pygmentized code blocks.
*/
html,body{color:black}*:not('#mkdbuttons'){margin:0;padding:0}#wrapper{font:13.34px helvetica,arial,freesans,clean,sans-serif;-webkit-font-smoothing:subpixel-antialiased;line-height:1.4;padding:3px;background:#fff;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px}p{margin:1em 0}a{color:#4183c4;text-decoration:none}#wrapper{background-color:#fff;padding:30px;margin:15px;font-size:14px;line-height:1.6}#wrapper>*:first-child{margin-top:0!important}#wrapper>*:last-child{margin-bottom:0!important}@media screen{#wrapper{box-shadow:0 0 0 1px #cacaca,0 0 0 4px #eee}}h1,h2,h3,h4,h5,h6{margin:20px 0 10px;padding:0;font-weight:bold;-webkit-font-smoothing:subpixel-antialiased;cursor:text}h1{font-size:28px;color:#000}h2{font-size:24px;border-bottom:1px solid #ccc;color:#000}h3{font-size:18px;color:#333}h4{font-size:16px;color:#333}h5{font-size:14px;color:#333}h6{color:#777;font-size:14px}p,blockquote,table,pre{margin:15px 0}ul{padding-left:30px}ol{padding-left:30px}ol li ul:first-of-type{margin-top:0}hr{background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;border:0 none;color:#ccc;height:4px;padding:0}#wrapper>h2:first-child{margin-top:0;padding-top:0}#wrapper>h1:first-child{margin-top:0;padding-top:0}#wrapper>h1:first-child+h2{margin-top:0;padding-top:0}#wrapper>h3:first-child,#wrapper>h4:first-child,#wrapper>h5:first-child,#wrapper>h6:first-child{margin-top:0;padding-top:0}a:first-child h1,a:first-child h2,a:first-child h3,a:first-child h4,a:first-child h5,a:first-child h6{margin-top:0;padding-top:0}h1+p,h2+p,h3+p,h4+p,h5+p,h6+p,ul li>:first-child,ol li>:first-child{margin-top:0}dl{padding:0}dl dt{font-size:14px;font-weight:bold;font-style:italic;padding:0;margin:15px 0 5px}dl dt:first-child{padding:0}dl dt>:first-child{margin-top:0}dl dt>:last-child{margin-bottom:0}dl dd{margin:0 0 15px;padding:0 15px}dl dd>:first-child{margin-top:0}dl dd>:last-child{margin-bottom:0}blockquote{border-left:4px solid #DDD;padding:0 15px;color:#777}blockquote>:first-child{margin-top:0}blockquote>:last-child{margin-bottom:0}table{border-collapse:collapse;border-spacing:0;font-size:100%;font:inherit}table th{font-weight:bold;border:1px solid #ccc;padding:6px 13px}table td{border:1px solid #ccc;padding:6px 13px}table tr{border-top:1px solid #ccc;background-color:#fff}table tr:nth-child(2n){background-color:#f8f8f8}img{max-width:100%}code,tt{margin:0 2px;padding:0 5px;white-space:nowrap;border:1px solid #eaeaea;background-color:#f8f8f8;border-radius:3px;font-family:Consolas,'Liberation Mono',Courier,monospace;font-size:12px;color:#333}pre>code{margin:0;padding:0;white-space:pre;border:0;background:transparent}.highlight pre{background-color:#f8f8f8;border:1px solid #ccc;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px;border-radius:3px}pre{background-color:#f8f8f8;border:1px solid #ccc;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px;border-radius:3px}pre code,pre tt{background-color:transparent;border:0}.poetry pre{font-family:Georgia,Garamond,serif!important;font-style:italic;font-size:110%!important;line-height:1.6em;display:block;margin-left:1em}.poetry pre code{font-family:Georgia,Garamond,serif!important;word-break:break-all;word-break:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;hyphens:auto;white-space:pre-wrap}sup,sub,a.footnote{font-size:1.4ex;height:0;line-height:1;vertical-align:super;position:relative}sub{vertical-align:sub;top:-1px}@media print{body{background:#fff}img,pre,blockquote,table,figure{page-break-inside:avoid}#wrapper{background:#fff;border:0}code{background-color:#fff;color:#333!important;padding:0 .2em;border:1px solid #dedede}pre{background:#fff}pre code{background-color:white!important;overflow:visible}}@media screen{body.inverted{color:#eee!important;border-color:#555;box-shadow:none}.inverted #wrapper,.inverted hr .inverted p,.inverted td,.inverted li,.inverted h1,.inverted h2,.inverted h3,.inverted h4,.inverted h5,.inverted h6,.inverted th,.inverted .math,.inverted caption,.inverted dd,.inverted dt,.inverted blockquote{color:#eee!important;border-color:#555;box-shadow:none}.inverted td,.inverted th{background:#333}.inverted pre,.inverted code,.inverted tt{background:#444!important;border-color:#111}.inverted h2{border-color:#555}.inverted hr{border-color:#777;border-width:1px!important}::selection{background:rgba(157,193,200,0.5)}h1::selection{background-color:rgba(45,156,208,0.3)}h2::selection{background-color:rgba(90,182,224,0.3)}h3::selection,h4::selection,h5::selection,h6::selection,li::selection,ol::selection{background-color:rgba(133,201,232,0.3)}code::selection{background-color:rgba(0,0,0,0.7);color:#eee}code span::selection{background-color:rgba(0,0,0,0.7)!important;color:#eee!important}a::selection{background-color:rgba(255,230,102,0.2)}.inverted a::selection{background-color:rgba(255,230,102,0.6)}td::selection,th::selection,caption::selection{background-color:rgba(180,237,95,0.5)}.inverted{background:#0b2531;background:#252a2a}.inverted #wrapper{background:#252a2a}.inverted a{color:#acd1d5}}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k,.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#800080;font-weight:bold}.highlight .gt{color:#a00}.highlight .kc,.highlight .kd,.highlight .kn,.highlight .kp,.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:#008080}.highlight .nb{color:#0086b3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:#008080}.highlight .ni{color:#800080}.highlight .ne,.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:#000080}.highlight .nv{color:#008080}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:#099}.highlight .sb,.highlight .sc,.highlight .sd,.highlight .s2,.highlight .se,.highlight .sh,.highlight .si,.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc,.highlight .vg,.highlight .vi{color:#008080}.highlight .il{color:#099}.highlight .gc{color:#999;background-color:#eaf2f5}.type-csharp .highlight .k,.type-csharp .highlight .kt{color:#00F}.type-csharp .highlight .nf{color:#000;font-weight:normal}.type-csharp .highlight .nc{color:#2b91af}.type-csharp .highlight .nn{color:#000}.type-csharp .highlight .s,.type-csharp .highlight .sc{color:#a31515}
</style>

</head>
<body class="normal">
  <div id="wrapper">
      <h1 id="artifactreview:paper182object-orientedpicklers">Artifact Review: Paper 182, Object-Oriented Picklers</h1>

<p><em>Authors: Heather Miller, Philipp Haller, Eugene Burmako, Martin Odersky</em></p>

<p>Our paper presented (a) a model of &#8220;object-oriented picklers&#8221; and (b) a
framework for generating them. This guide describes how to get started with
(b), the framework for generating the object-oriented pickler combinators.</p>

<p>Scala-pickling aims to be very easy to use and to require little to no
boilerplate at all. For pickling, the basic usage is:</p>

<pre><code>import scala.pickling._
import json._
// or import binary._ to pickle to binary format instead

val pckl = List(1, 2, 3, 4).pickle
</code></pre>

<p>Unpickling is just as simple, its basic usage is:</p>

<pre><code>val lst = pckl.unpickle[List[Int]]
</code></pre>

<h3 id="apidocs">API Docs</h3>

<p>(Local) API documentation is also included and available at:
<a href="api-docs/index.html">api-docs/index.html</a></p>

<h3 id="source">Source</h3>

<p>(Local) Source code for the scala-pickling project is also
included and available at:
<a href="core/src/main/scala/pickling">core/src/main/scala/pickling</a></p>

<h2 id="gettingstartedguide">Getting Started Guide</h2>

<p>This guide assumes you have Java 1.6 on your path. Other than that, this
archive contains all that you will need to experiment with the scala-pickling
project.</p>

<p>You will primarily be using a Scala build tool called SBT (included).</p>

<p>To experiment, you have a few ways to interact with scala-pickling:</p>

<ol>
<li><strong><a href="#ourtestsuite">Our Test Suite</a></strong>, run (or tweak) the &gt;90 tests in our test suite.</li>
<li><strong><a href="#ourbenchmarks">Our Benchmark Scripts</a></strong>, reproduce our benchmark results locally on your architecture.</li>
<li><strong><a href="#usingscala-picklingwiththestandalonescalacompileroptional">Use Scala-Pickling with the Standalone Scala Compiler</a></strong>, write your own independent Scala programs and run them with scala-pickling <strong>[this is optional]</strong></li>
</ol>

<p>Because running the test suite and benchmarks are done through SBT, we first
show you how to start and use SBT. We will then show how to get started with
each of the thee possibilities above.</p>

<h3 id="startingsbt">Starting SBT</h3>

<p>Our test suite and benchmarks can be run using SBT (a Scala build tool). SBT
is included in this distribution (at <code>bin/sbt</code>).</p>

<p><strong>Before running SBT it is necessary to adjust the absolute directory path of
the local Scala build in file <a href="project/Build.scala">project/Build.scala</a>.
Adjust the path on line 12 to match the directory into which you unpacked the
archive.</strong></p>

<p>Then, to start SBT simply do:</p>

<pre><code>bin/sbt
</code></pre>

<p>SBT will then print the status of fetching its (locally-included)
dependencies. After that, you&#8217;ll see a <code>&gt;</code> prompt. That&#8217;s it, SBT is now
started!</p>

<h4 id="startingthereplfromsbt">Starting the REPL from SBT</h4>

<p>One can also interact with scala-pickling from SBT by simply starting the
REPL. Once SBT is started (as per the instructions in the section above),
simply do:</p>

<pre><code>&gt; console
</code></pre>

<p>SBT will then compile scala-pickling and start the REPL. After compilation,
you should see the following prompt:</p>

<pre><code>[info] Starting scala interpreter...
[info]
Welcome to Scala version 2.11.0-20130521-221431-39227d0382 (Java HotSpot(TM) 64-Bit Server VM, Java 1.6.0_43).
Type in expressions to have them evaluated.
Type :help for more information.

scala&gt;
</code></pre>

<p>Example usage:</p>

<pre><code>scala&gt; import scala.pickling._
import scala.pickling._

scala&gt; import json._
import json._

scala&gt; val p = &quot;hi there!&quot;.pickle
p: scala.pickling.json.JSONPickle =
JSONPickle({
  &quot;tpe&quot;: &quot;java.lang.String&quot;,
  &quot;value&quot;: &quot;hi there!&quot;
})

scala&gt; p.unpickle[String]
res0: String = hi there!
</code></pre>

<p>To quit the REPL (without quitting SBT), type <code>:q</code></p>

<h3 id="ourtestsuite">#1 Our Test Suite</h3>

<p>To run the tests, once SBT is started, simply do:</p>

<pre><code>&gt; test
</code></pre>

<p>SBT will compile scala-pickling as well as all of the test files, and will
print output representing the status (pass/fail) all of its tests.</p>

<h3 id="ourbenchmarks">#2 Our Benchmarks</h3>

<p>To run the benchmarks shown in the paper, once SBT is started, simply do:</p>

<pre><code>&gt; travInt
</code></pre>

<p>This shows the results of scala-pickling for the main benchmark described in
section 7 (Experimental Evaluation) of the paper. This is the &#8220;time&#8221; benchmark
(Figure 1a), not the memory or size benchmarks shown in Figure 1b or 1c.</p>

<p>The values printed to the screen are milliseconds. Each row represents
independent JVM runs for values on the x-axis of the graph; for <code>travInt</code>,
this means each row represents a different length of the <code>Vector</code> as described
in the paper (from 100,000 to 1,000,000, from top to bottom). Each column
corresponds to a separate run of the benchmark.</p>

<p>The other two benchmarks, shown in Figure 1b (free memory), and Figure 1c
(size) can be run from SBT using the following commands, respectively:</p>

<pre><code>&gt; travIntFreeMem
&gt; travIntSize
</code></pre>

<p>The values on the x-axis for <code>travIntFreeMem</code> and <code>travIntSize</code> are both in Bytes.</p>

<p><em>Note that SBT will set the following flags for you (as we have done for our benchmarks, and have described in section 7 of the paper):</em> <code>-Xms1536M - Xmx4096M -Xss2M -XX:MaxPermSize=512M -XX:+UseParallelGC</code></p>

<p>We also include two additional benchmarks not shown in the paper, but
published on our project page:
<a href="http://lampwww.epfl.ch/~hmiller/pickling/benchmarks/">Scala Pickling:Benchmarks</a>
<br>(We do have google analytics on our project website, but the project site
is public, linked to on github and other sites, and gets traffic, so there is
no real risk of tracing.)</p>

<p>Included are the following benchmarks:</p>

<ul>
<li><code>geoTrellis</code>. <a href="http://lampwww.epfl.ch/~hmiller/pickling/benchmarks/geotrellis.html">GeoTrellis benchmark</a> varied up to 1,000,000 elements. To run this benchmark, simply do <code>geoTrellis</code> within SBT.</li>
<li><code>evactor1</code>. <a href="http://lampwww.epfl.ch/~hmiller/pickling/benchmarks/evactor.html">Evactor benchmark</a> varied up to
10,000 events. To run this benchmark, simply do <code>evactor1</code> within SBT.</li>
<li><code>evactor2</code>. <a href="http://lampwww.epfl.ch/~hmiller/pickling/benchmarks/evactor.html">Evactor benchmark</a> varied up to 38,000 events. To run this benchmark, simply do <code>evactor2</code> within SBT.</li>
</ul>

<h3 id="usingscala-picklingwiththestandalonescalacompileroptional">#3 Using Scala-Pickling with the Standalone Scala Compiler [Optional]</h3>

<p>Also included in this archive is a standalone version of the Scala compiler
which can be used with scala-pickling. It is located at <code>scala-local/bin/scalac</code>.
We provide this option for those who would like to avoid
the use of build tools. The use of the standalone compiler is completely
optional.</p>

<p><em>Note: this requires that you first build scala-pickling with SBT as described above</em></p>

<p><strong>Example</strong>, for a program <code>test.scala</code>:</p>

<pre><code>import scala.pickling._
import binary._

object Test extends App {
  val x = 42
  val p = x.pickle
  val up = p.unpickle[Int]
  println(&quot;unpickled: &quot;+ up)
}
</code></pre>

<p>To compile:
<br>(with a local directory <code>classes</code> for the classfiles)</p>

<pre><code>$ scala-local/bin/scalac -d classes -cp core/target/scala-2.11/classes test.scala
</code></pre>

<p>To run:</p>

<pre><code>$ scala-local/bin/scala -cp classes:core/target/scala-2.11/classes Test
</code></pre>

<h2 id="step-by-stepinstructions">Step-by-Step Instructions</h2>

<p>The simplest and quickest way to experiment with the scala-pickling project,
is to simply tweak tests or add new tests to our test suite.</p>

<p>If you would rather not interact with the test suite, we offer the following
alternate suggestions for interacting with the scala-pickling project:</p>

<ol>
<li><strong>Adding/Tweaking Tests in the Test Suite</strong>, tweak existing tests or add new tests to the &gt;90 tests in our test suite.</li>
<li><strong>Experiment in the REPL</strong>, test new inputs in SBT&#8217;s <code>console</code>.</li>
<li><strong>Use Scala-Pickling with the Standalone Scala Compiler</strong>, write your own independent Scala programs and run them with scala-pickling (this is optional)</li>
</ol>

<p>(We also provide the scripts to reproduce the benchmarks in our paper. You may
change those and re-run them if you&#8217;d like as well.)</p>

<p>We provide suggestions below for</p>

<h3 id="addingtweakingtestsinthetestsuite">#1 Adding/Tweaking Tests in the Test Suite</h3>

<p>Have a look around&#8230;</p>

<p>In the following section, we first describe the different types of tests in
our test suite.</p>

<h4 id="tests">Tests</h4>

<p>There are two types of tests:</p>

<ul>
<li>Unit Tests</li>
<li>ScalaCheck Tests</li>
</ul>

<p>Both types of tests are located in the directory:
<a href="core/src/test/scala/pickling">core/src/test/scala/pickling</a>.</p>

<p><strong>Unit Tests</strong> typically do some task, and then assert that a result is a
certain value. A simple example of one of our unit tests is:
<a href="core/src/test/scala/pickling/simple-case-class.scala">core/src/test/scala/pickling/simple-case-class.scala</a>.</p>

<p>Note that nearly all files in the testing directory
(<a href="core/src/test/scala/pickling">core/src/test/scala/pickling</a>)
are unit tests.</p>

<p><strong>ScalaCheck Tests</strong> generate random inputs for a specified test, and runs
the test 100 times with 100 different inputs.</p>

<p>Our ScalaCheck Tests for JSON and binary formats are both in the same file:
<a href="core/src/test/scala/pickling/pickling-spec.scala">core/src/test/scala/pickling/pickling-spec.scala</a>.
JSON and binary tests exist in the <code>PicklingBinarySpec</code> and <code>PicklingJsonSpec</code>
singleton objects, respectively.</p>

<h2 id="knownlimitations">Known Limitations</h2>

<p>At the time of writing this guide, the scala-pickling project has the following known limitations:</p>

<ul>
<li>At this time, <code>Double</code>s are not supported by our <strong>binary</strong> pickle format. However, all other numerics (<code>Float</code>, <code>Int</code>, <code>Long</code>, etc) are. (Note that all primitives are supported by the JSON pickle format, however.)</li>
<li>It is possible to switch between runtime compilation and runtime interpretation (as the runtime fallback mechanism), based on the user&#8217;s preference. Although at present, the switch is manual- to toggle between the two, one must change lines 121 &amp; 139 in source file <a href="core/src/main/scala/pickling/package.scala">core/src/main/scala/pickling/package.scala</a>.</li>
<li>At this time, pickling and unpickling the Scala <code>Unit</code> type is not supported.</li>
<li>As indicated in the &#8220;future work&#8221; section of the paper, pickling closures is not yet supported, as an arbitrary closure can capture arbitrarily anything in its environment. This is beyond the scope of the current paper, and has required a solution specialized to closures (this is work done in parallel, but separate from the paper submitted to OOPSLA).</li>
</ul>
    </div>
</body>
</html>